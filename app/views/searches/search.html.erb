<% if @routes.empty? %>
  <h2>Search query without results</h2>
<% else %>
  <h2>Search result:</h2>
  <table class="table">
    <thead>
      <th>Route</th>
      <th><%= @departure_station.title %> Departure Time</th>
      <th><%= @arrival_station.title %> Arrival Time</th>
    </thead>
    <tbody>
      <% @routes.each do |route| %>
        <tr>
          <td><%= route.name %></td>
          <td><%= route.railway_station_route(@departure_station).departure_time.try(:strftime,"%d.%m.%y - %H:%M") %></td>
          <td><%= route.railway_station_route(@arrival_station).arrival_time.try(:strftime,"%d.%m.%y - %H:%M") %>
          <% route.trains.each do |train| %>
            <tr>
              <td><strong>Train:</strong></td>
              <td><%= train.number %></td>
              <td><%= link_to 'Buy Ticket', new_ticket_path(begin_station_id: @departure_station.id,
                              end_station_id: @arrival_station.id, train_id: train.id, route_id: route.id),
                              class: 'btn btn-primary'%></td>
            </tr>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
<% end %>

<%= link_to 'Back', search_path, method: :get, class: 'btn btn-warning' %>
